(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["login"],{"0290":function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"login-wrap"},[o("div",{staticClass:"ms-login"},[o("div",{staticClass:"ms-title"},[e._v("雷达数据生成系统")]),o("el-form",{ref:"loginFormRef",staticClass:"ms-content",attrs:{model:e.loginForm,rules:e.loginFormRules,"label-width":"0px"}},[o("el-form-item",{attrs:{prop:"username"}},[o("el-input",{attrs:{placeholder:"username"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}},[o("el-button",{attrs:{slot:"prepend",icon:"el-icon-lx-people"},slot:"prepend"})],1)],1),o("el-form-item",{attrs:{prop:"password"}},[o("el-input",{attrs:{type:"password",placeholder:"password"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm()}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}},[o("el-button",{attrs:{slot:"prepend",icon:"el-icon-lx-lock"},slot:"prepend"})],1)],1),o("div",{staticClass:"login-btn"},[o("el-button",{attrs:{type:"primary",loading:e.loading,"element-loading-spinner":"el-icon-loading","element-loading-text":"登录中"},on:{click:function(t){return e.submitForm()}}},[e._v("登录")])],1),o("p",{staticClass:"login-tips"},[e._v("Tips : 本系统暂未开放注册功能。")])],1)],1)])},s=[],r=(o("96cf"),o("1da1")),i=o("4328"),a=o.n(i),l={data:function(){return{loginForm:{username:"",password:""},loginFormRules:{username:[{required:!0,message:"账号不可为空",trigger:"blur"}],password:[{required:!0,message:"密码不可为空",trigger:"blur"}]},loading:!1,flag:!0}},methods:{submitForm:function(){var e=this;this.loading=!0,this.$refs.loginFormRef.validate(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(o){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("this.loginFormRules:"),console.log(e.loginFormRules),!o){t.next=32;break}if(console.log(e.loginForm),!0!==e.flag){t.next=32;break}return e.flag=!1,t.next=8,e.$http.post("/user/login/",a.a.stringify(e.loginForm));case 8:if(n=t.sent,s=n.data,console.log("login-data"),console.log(s),2e4===s.code){t.next=19;break}return console.log(s.code),e.loginForm.password="",e.loading=!1,t.abrupt("return",e.$message.error("登录失败,请检查用户名或密码是否正确"));case 19:e.$store.commit("setToken",null),console.log("$store.token已清除"),window.sessionStorage.setItem("username",e.loginForm.username),window.sessionStorage.setItem("password",e.loginForm.password),e.$store.commit("setUserId",s.data.profile.id),console.log("this.$store.state.userId"+e.$store.state.userId),e.$store.commit("setToken",s.data.token),e.$store.commit("setUser_group_name",s.data.profile.user_group_name),e.getUserRight(),e.$message.success("登录成功"),e.$router.push("/dashboard"),e.loading=!1,e.flag=!0;case 32:e.loading=!1;case 33:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},getUserRight:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("/user/");case 2:t=e.sent,o=t.data,console.log("getUserRight-user1:"),console.log(o),this.$store.commit("setNickName",o.data.nickname),console.log("window.sessionStorage.getItem('nickname'):"+window.sessionStorage.getItem("nickname")),console.log("this.$store.state.token:"+this.$store.state.token),console.log("this.$store.state.nickname:"+this.$store.state.nickname),console.log(window.sessionStorage.getItem("user_group_name")+o.data.username);case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},u=l,c=(o("cdbf"),o("2877")),m=Object(c["a"])(u,n,s,!1,null,"bd244e18",null);t["default"]=m.exports},"1da1":function(e,t,o){"use strict";function n(e,t,o,n,s,r,i){try{var a=e[r](i),l=a.value}catch(u){return void o(u)}a.done?t(l):Promise.resolve(l).then(n,s)}function s(e){return function(){var t=this,o=arguments;return new Promise((function(s,r){var i=e.apply(t,o);function a(e){n(i,s,r,a,l,"next",e)}function l(e){n(i,s,r,a,l,"throw",e)}a(void 0)}))}}o.d(t,"a",(function(){return s}))},"64bb":function(e,t,o){},cdbf:function(e,t,o){"use strict";o("64bb")}}]);